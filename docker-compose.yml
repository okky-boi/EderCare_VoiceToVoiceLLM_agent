version: "3.8"

services:
    mochi-bot:
        build: .
        container_name: mochi-bot
        ports:
            - "127.0.0.1:8051:8051"
        volumes:
            - ./models:/app/models
            - ./audio_cache:/app/audio_cache
        environment:
            - PYTHONUNBUFFERED=1
            - PYTHONDONTWRITEBYTECODE=1
        restart: unless-stopped
        healthcheck:
            test: ["CMD", "curl", "-f", "http://localhost:8051/health"]
            interval: 30s
            timeout: 10s
            retries: 3
            start_period: 40s
